<!DOCTYPE html>
<html lang="pt-br">
<head th:insert="fragment.html :: links">
<meta charset="UTF-8">
</head>
<body>

	<div class="container-fluid">

		<div th:insert="fragment.html :: loggedtopnav"></div>
		<div th:insert="fragment.html :: sidebaremp"></div>
		<div class="container-fluid content">
			<div class="row my-3 ml-1">

				<div class="col-lg-6 d-flex graficos px-1 justify-content-center">
					<div class="col-sm-12 box white">
						<canvas id="mais-inscritos" height="200"></canvas>
					</div>
				</div>
				<div class="col-lg-6 d-flex pl-1 graficos justify-content-center">
					<div class="col-sm-12 box white">
						<canvas id="inscritos-submissoes" height="200"></canvas>
					</div>
				</div>
			</div>
			<div class="row my-3 ml-1">
				<a class="col-12 text-center" th:attr="href='/addDesafio'" > <i
					class="fas fa-plus-circle"></i> Criar novo desafio
				</a>
			</div>
			<div class="row meus-desafios">
				<div class="col-lg-8 mx-auto mb-2">
					<div class="col-sm-12 filtro">
						
						Estado
                        <select class="white filtro-estado">
                            <option>Todos</option>
                            <option>Finalizados</option>
                            <option>Em andamento</option>
                        </select>
						Área
						<select class="white filtro-area">
                            <option>Todos</option>
                            <option>Front-end</option>
                            <option>Back-end</option>
                            <option>Full stack</option>
                            <option>Data Science</option>
                        </select>
					</div>
                    <span class="none-result">Nenhum resultado encontrado</span>
                    <div class="row desafios">
                    </div>
				</div>
			</div>

		</div>

	</div>


	<script th:src="@{/js/moldesComponentes.js}"></script>
	<script th:inline="javascript">
		var desafios = [[${desafios}]]; //Your Thymleaf variable
		
		
		for(var i = 0; i < desafios.length; i++){
			var emailEmpresa = desafios[i].emailEmpresa;
			var id = desafios[i].id
			//console.log(desafios[i])
			$.ajax({
    	    	url:'desafioHabilidades/'+emailEmpresa+'/'+id,
	    	    type: "GET",
	    	    async: false,
	            contentType: "application/json",
	    	    data:{
	    	    	
	    	    },
	    	    success: function(response) {
	    	    	
	    	    	var habilidades = []
	    	    
	    	    	for(var j = 0; j < response.length; j++){
	    	    		habilidades.push(response[j].habilidade)
	    	    	}
	    	    	desafios[i].habilidades = habilidades
	    	    	
    	        },
	    	    error: function(error){
	    	    	console.log(error)
	    	    }
			})
		}
		desafios.forEach(function (item, index) {
		    criarDesafioEmpresa(item.id, item.nome, item.empresa.nomeFantasia, 
		    			item.areaDesenvolvimento, item.descricao, item.habilidades, item.dataFim, item.horarioFim)
		})
	</script>
	<script>
        
        var ctxBar = document.getElementById('mais-inscritos').getContext('2d');
        var ctxDoughnut = document.getElementById('inscritos-submissoes').getContext('2d');

        var myChart = new Chart(ctxBar, {
            type: 'horizontalBar',
            data: {
                labels: ['App de fisica', 'App de táxi', 'Rede social', 'App de floricultura', ],
                datasets: [{
                    label: 'Desafios',
                    data: [19, 12, 5, 3, 3, 2],
                    backgroundColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                }]
            },
        });

        var myDoughnutChart = new Chart(ctxDoughnut, {
            type: 'line',
            data: {
                labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
                datasets: [{
                    label: 'Submissões por mês',
                    backgroundColor: 'red',
                    borderColor: 'red',
                    data: [
                        2, 3, 4, 3, 2, 1, 3
                    ],
                    fill: false,
                }]
            },
        });

    </script>
	<script th:src="@{/js/filtroDesafio.js}"></script>
	
</body>
</html>